## 在高并发和大数据量的场景下，一些很实用的建议

### 代码层面：
1. 代码里面不要连表操作，请用代码逻辑处理join逻辑。
ps: 想象一下200万 join 300万的表，如果连表操作，会导致内存溢出。同时会增加数据库的处理时间。

2. 不要在for循环里面进行数据库操作。
ps: 会导致数据库连接过多，导致数据库连接池溢出。 

3. 一个业务接口尽量只做一件事情。
ps: 让业务接口的逻辑更加清晰，方便后期维护。 

4. 不要在业务接口里面进行复杂的查询对比和统计算法。
ps: 尽量用异步解耦的方式去处理，比如用消息队列，定时任务什么的。 

5. 注意错误日志的打印。
ps: 越是详细的错误日志，越能帮助我们快速定位和解决问题。

6. 注意代码的可读性。比如：一个if里面如果包含很长的代码，那么可以考虑反向判断。

### 数据层面:

1. 数据库的每一次查询，请注意是否用到了索引。
ps:看似很简单，如果没有索引，上线直接会把数据库内存拉满。

2. 注意redis的缓存击穿问题，尽量用分布式锁解决。
ps: 一般是在高并发的场景下，大量的请求同时访问一个key，导致redis的压力过大，从而导致redis宕机。
    同时，这个key的缓存失效时间又很短，导致大量的请求都会访问数据库，从而导致数据库宕机。

3. 优雅的做好数据容错和一致性处理，如果数据不一致，问题排查和数据清洗那就是灾难。
ps: 框架基本都是支持嵌套事务的，但是嵌套事务会导致数据库的性能下降，所以我们要尽量避免嵌套事务。
    但是，如果我们不用嵌套事务，那么就会导致数据的不一致性，所以我们要优雅的处理这个问题。

